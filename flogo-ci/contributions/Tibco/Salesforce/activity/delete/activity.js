"use strict";var __extends=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__decorate=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeleteActivityService=void 0;var http_1=require("@angular/http"),core_1=require("@angular/core"),wi_contrib_1=require("wi-studio/app/contrib/wi-contrib"),Observable_1=require("rxjs/Observable"),activity_schema_services_1=require("./activity.schema.services"),DeleteActivityService=function(t){function e(e){var n=t.call(this)||this;return n.http=e,n.value=function(t,e){switch(t){case"Connection Name":return Observable_1.Observable.create(function(t){var e=[];wi_contrib_1.WiContributionUtils.getConnections(n.http,"Salesforce").subscribe(function(n){n.forEach(function(t){for(var n=0;n<t.settings.length;n++)if("name"===t.settings[n].name){e.push({unique_id:wi_contrib_1.WiContributionUtils.getUniqueId(t),name:t.settings[n].value});break}}),t.next(e)})});case"Object Name":var i=e.getField("Connection Name").value;return i?Observable_1.Observable.create(function(t){var e=[];wi_contrib_1.WiContributionUtils.getConnection(n.http,i).map(function(t){return t}).subscribe(function(i){for(var r={},s="",o="",a="Production",c="",u="",l=!1,_=!1,v="",b="",f=3,p="",g=0;g<i.settings.length;g++)"authType"===i.settings[g].name&&(o=i.settings[g].value),"WI_STUDIO_OAUTH_CONNECTOR_INFO"===i.settings[g].name&&(r=i.settings[g].value.startsWith("{")?JSON.parse(i.settings[g].value):JSON.parse(atob(i.settings[g].value))),"apiVersion"===i.settings[g].name&&(s=i.settings[g].value),"environment"===i.settings[g].name&&(a=i.settings[g].value),"clientSecret"===i.settings[g].name&&(c=i.settings[g].value),"jwt"===i.settings[g].name&&(u=i.settings[g].value),"customOAuth2Credentials"===i.settings[g].name&&(l=i.settings[g].value),"clientId"===i.settings[g].name&&(v=i.settings[g].value),"generateJwt"===i.settings[g].name&&(_=i.settings[g].value),"subject"===i.settings[g].name&&(b=i.settings[g].value),"jwtExpiry"===i.settings[g].name&&(f=i.settings[g].value),"clientKey"===i.settings[g].name&&""!==i.settings[g].value&&(p=i.settings[g].value.content,p=atob(p.split("base64,")[1]));wi_contrib_1.WiContributionUtils.getAppConfig(n.http).subscribe(function(t){t.deployment===wi_contrib_1.APP_DEPLOYMENT.ON_PREMISE&&(l=!0)}),r.api_version=s,r.client_secret=c,r.jwt=u,r.customOAuth2Credentials=l,r.client_id=v,r.subject=b,r.jwtExpiry=f,r.clientPrivateKey=p,"OAuth 2.0 JWT Bearer Flow"===o||l&&""!==r.client_secret&&void 0!==r.client_id||!l?activity_schema_services_1.SFSchemaServices.getObjects(n.http,r,a,o,_).subscribe(function(n){n.forEach(function(t){e.push(t.name)}),t.next(e)},function(e){t.error("Failed to get SF objects due to: "+JSON.stringify(e))},function(){t.complete()}):t.next(null)})}):null;default:return null}},n.validate=function(t,e){return null},n}return __extends(e,t),e=__decorate([core_1.Injectable(),wi_contrib_1.WiContrib({}),core_1.Injectable(),__metadata("design:paramtypes",[http_1.Http])],e)}(wi_contrib_1.WiServiceHandlerContribution);exports.DeleteActivityService=DeleteActivityService;
//# sourceMappingURL=activity.js.map
