"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__decorate=this&&this.__decorate||function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(exports,"__esModule",{value:!0});var http_1=require("@angular/http"),core_1=require("@angular/core"),wi_contrib_1=require("wi-studio/app/contrib/wi-contrib"),contrib_1=require("wi-studio/common/models/contrib"),validation_1=require("wi-studio/common/models/validation"),Observable_1=require("rxjs/Observable"),LambdaFunctionInvokeService=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.http=n,i.value=function(e,t){return"ConnectionName"===e?Observable_1.Observable.create(function(e){var t=[];wi_contrib_1.WiContributionUtils.getConnections(i.http,"AWS").subscribe(function(n){console.log("connection ref response: ",n),n.forEach(function(e){for(var n=0;n<e.settings.length;n++)if("name"===e.settings[n].name){t.push({unique_id:wi_contrib_1.WiContributionUtils.getUniqueId(e),name:e.settings[n].value});break}}),console.log("connection ref is:",t),e.next(t),console.log(n)})}):null},i.validate=function(e,t){if("payload"===e){if(!(n=t.getField("payload")).value)return validation_1.ValidationResult.newValidationResult().setError("SCHEMA_ERROR","Unexpected string in JSON");try{JSON.parse(JSON.stringify(n.value))}catch(e){return validation_1.ValidationResult.newValidationResult().setError("SCHEMA_ERROR","Unexpected string in JSON")}}if("ReplyData"===e){if(t.getMode()!==contrib_1.MODE.WIZARD)return console.log("Lambda InvokeSync Unknown Context Mode: ",t.getMode()),validation_1.ValidationResult.newValidationResult().setVisible(!0);var n;if((n=t.getField("ReplyData")).value)try{JSON.parse(JSON.stringify(n.value))}catch(e){return validation_1.ValidationResult.newValidationResult().setError("SCHEMA_ERROR","Unexpected string in JSON")}}return null},i}return __extends(t,e),t}(wi_contrib_1.WiServiceHandlerContribution);LambdaFunctionInvokeService=__decorate([core_1.Injectable(),__param(0,core_1.Inject(core_1.Injector)),__metadata("design:paramtypes",[Object,http_1.Http])],LambdaFunctionInvokeService),exports.LambdaFunctionInvokeService=LambdaFunctionInvokeService;
//# sourceMappingURL=activity.js.map
