"use strict";var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),__decorate=this&&this.__decorate||function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionActivityService=void 0;var http_1=require("@angular/http"),core_1=require("@angular/core"),wi_contrib_1=require("wi-studio/app/contrib/wi-contrib"),Observable_1=require("rxjs/Observable"),FIELD_ACTION="Action",FIELD_CONNECTION="Connection",FIELD_INPUT="input",FIELD_OUTPUT="output",VALUE_CAMPAIGNS="Campaigns",VALUE_SEND="Send",VALUE_SCHEDULE="Schedule",VALUE_TEST="Test",ActionActivityService=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.http=i,r.value=function(e,t){switch(e){case FIELD_CONNECTION:return Observable_1.Observable.create(function(e){var t=[];wi_contrib_1.WiContributionUtils.getConnections(r.http,"Mailchimp").subscribe(function(i){i.forEach(function(e){for(var i=0;i<e.settings.length;i++)if("name"===e.settings[i].name){t.push({unique_id:wi_contrib_1.WiContributionUtils.getUniqueId(e),name:e.settings[i].value});break}}),e.next(t)})});case FIELD_INPUT:return Observable_1.Observable.create(function(e){switch(t.getField(FIELD_ACTION).value){case VALUE_SEND:e.next(JSON.stringify(INPUT_SEND));break;case VALUE_SCHEDULE:e.next(JSON.stringify(INPUT_SCHEDULE));break;case VALUE_TEST:e.next(JSON.stringify(INPUT_TEST));break;default:e.next(null)}});case FIELD_OUTPUT:t.getField(FIELD_ACTION).value;return Observable_1.Observable.create(function(e){e.next(JSON.stringify(OUTPUT))})}},r.validate=function(e,t){return null},r}return __extends(t,e),t=__decorate([core_1.Injectable(),wi_contrib_1.WiContrib({}),core_1.Injectable(),__param(0,core_1.Inject(core_1.Injector)),__metadata("design:paramtypes",[Object,http_1.Http])],t)}(wi_contrib_1.WiServiceHandlerContribution);exports.ActionActivityService=ActionActivityService;var OUTPUT={$id:"http://example.com/example.json",type:"object",definitions:{},$schema:"http://json-schema.org/draft-07/schema#",properties:{success:{type:"boolean"}}},INPUT_SEND={$id:"http://example.com/example.json",type:"object",definitions:{},$schema:"http://json-schema.org/draft-07/schema#",properties:{campaign_id:{type:"string"}},required:["campaign_id"]},INPUT_SCHEDULE={$id:"http://example.com/example.json",type:"object",definitions:{},$schema:"http://json-schema.org/draft-07/schema#",properties:{campaign_id:{type:"string"},data:{type:"object",properties:{schedule_time:{type:"string"},timewarp:{type:"boolean"},batch_delivery:{type:"object",properties:{batch_delay:{type:"boolean"},batch_count:{type:"boolean"}},required:["batch_delay","batch_count"]}},required:["schedule_time"]}},required:["campaign_id","data"]},INPUT_TEST={$id:"http://example.com/example.json",type:"object",definitions:{},$schema:"http://json-schema.org/draft-07/schema#",properties:{campaign_id:{type:"string"},data:{type:"object",properties:{test_emails:{type:"array",additionalItems:!1,items:{type:"string"}},send_type:{type:"string"}},required:["test_emails","send_type"]}},required:["campaign_id","data"]};
//# sourceMappingURL=activity.js.map
