"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__decorate=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,c=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(c=(o<3?i(c):o>3?i(t,r,c):i(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),http_1=require("@angular/http"),Observable_1=require("rxjs/Observable"),wi_contrib_1=require("wi-studio/app/contrib/wi-contrib"),OperationTypeList=[{unique_id:"get",name:"GET"},{unique_id:"put",name:"PUT"},{unique_id:"delete",name:"DELETE"}],ErrorSchema={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{code:{type:"string"},message:{type:"string"},statusCode:{type:"integer"},requestId:{type:"string"}}},IS_PRESIGN_GET={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","Key","ExpirationTimeSec"],properties:{Bucket:{type:"string"},Key:{type:"string"}}},IS_PRESIGN_PUT={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","Key","ExpirationTimeSec"],properties:{Bucket:{type:"string"},Key:{type:"string"}}},IS_PRESIGN_DELETE={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","Key","ExpirationTimeSec"],properties:{Bucket:{type:"string"},Key:{type:"string"}}},OS_PRESIGN_URL={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{PresignedURL:{type:"string"}}},presignHandler=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.injector=t,n.http=r,n.value=function(e,t){var r=t.getField("connection").value,i=t.getField("operationType").value;switch(e){case"connection":return Observable_1.Observable.create(function(e){var t=[];wi_contrib_1.WiContributionUtils.getConnections(n.http,"AWS").subscribe(function(r){console.log("connection ref response: ",r),r.forEach(function(e){for(var r=0;r<e.settings.length;r++)if("name"===e.settings[r].name){t.push({unique_id:wi_contrib_1.WiContributionUtils.getUniqueId(e),name:e.settings[r].value});break}}),console.log("connection ref is:",t),e.next(t),console.log(r)})});case"operationType":if(r)return OperationTypeList;break;case"input":if(r)return JSON.stringify(n.inputSchemaProvider(i));break;case"output":if(r)return JSON.stringify(n.outputSchemaProvider(i));break;case"error":if(r)return JSON.stringify(ErrorSchema)}},n.validate=function(e,t){return Observable_1.Observable.create(function(e){var t=wi_contrib_1.ValidationResult.newValidationResult();e.next(t)})},n.action=function(e,t){return Observable_1.Observable.create(function(e){var t=wi_contrib_1.ActionResult.newActionResult();e.next(t)})},n}return __extends(t,e),t.prototype.inputSchemaProvider=function(e){switch(e){case"get":return IS_PRESIGN_GET;case"put":return IS_PRESIGN_PUT;case"delete":return IS_PRESIGN_DELETE}},t.prototype.outputSchemaProvider=function(e){return OS_PRESIGN_URL},t}(wi_contrib_1.WiServiceHandlerContribution);presignHandler=__decorate([wi_contrib_1.WiContrib({}),core_1.Injectable(),__metadata("design:paramtypes",[core_1.Injector,http_1.Http])],presignHandler),exports.presignHandler=presignHandler;
//# sourceMappingURL=presignHandler.js.map
