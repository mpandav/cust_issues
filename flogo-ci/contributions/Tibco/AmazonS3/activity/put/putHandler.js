"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),__decorate=this&&this.__decorate||function(t,e,r,i){var n,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,r,s):n(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),http_1=require("@angular/http"),Observable_1=require("rxjs/Observable"),wi_contrib_1=require("wi-studio/app/contrib/wi-contrib"),ServiceNameList=[{unique_id:"bucket",name:"Bucket"},{unique_id:"object",name:"Object"}],PutTypeList=[{unique_id:"upload",name:"Upload"},{unique_id:"copy",name:"Copy"}],InputTypeList_TCI=[{unique_id:"text",name:"Text"}],InputTypeList_FE=[{unique_id:"file",name:"File"},{unique_id:"text",name:"Text"}],ErrorSchema={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{code:{type:"string"},message:{type:"string"},statusCode:{type:"integer"},requestId:{type:"string"}}},IS_CreateBucket={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket"],properties:{Bucket:{type:"string"},ACL:{type:"string"},CreateBucketConfiguration:{type:"object",properties:{LocationConstraint:{type:"string"}}},GrantFullControl:{type:"string"},GrantRead:{type:"string"},GrantReadACP:{type:"string"},GrantWrite:{type:"string"},GrantWriteACP:{type:"string"}}},IS_UploadObject_File={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","Key","SourceFilePath"],properties:{Bucket:{type:"string"},Key:{type:"string"},SourceFilePath:{type:"string"},ACL:{type:"string"},CacheControl:{type:"string"},ContentDisposition:{type:"string"},ContentEncoding:{type:"string"},ContentLanguage:{type:"string"},ContentLength:{type:"integer"},ContentMD5:{type:"string"},ContentType:{type:"string"},Expires:{type:"string",format:"date-time"},GrantFullControl:{type:"string"},GrantRead:{type:"string"},GrandReadACP:{type:"string"},GrantWriteACP:{type:"string"},RequestPayer:{type:"string"},SSECustomerAlgorithm:{type:"string"},SSECustomerKey:{type:"string"},SSECustomerKeyMD5:{type:"string"},SSEKMSKeyId:{type:"string"},ServerSideEncryption:{type:"string"},StorageClass:{type:"string"},Tagging:{type:"string"},UserMetadata:{type:"array",items:{type:"object",properties:{Key:{type:"string"},Value:{type:"string"}}}},WebsiteRedirectLocation:{type:"string"}}},IS_UploadObject_Text={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","Key","TextContent"],properties:{Bucket:{type:"string"},Key:{type:"string"},TextContent:{type:"string"},ACL:{type:"string"},CacheControl:{type:"string"},ContentDisposition:{type:"string"},ContentEncoding:{type:"string"},ContentLanguage:{type:"string"},ContentLength:{type:"integer"},ContentMD5:{type:"string"},ContentType:{type:"string"},Expires:{type:"string",format:"date-time"},GrantFullControl:{type:"string"},GrantRead:{type:"string"},GrandReadACP:{type:"string"},GrantWriteACP:{type:"string"},RequestPayer:{type:"string"},SSECustomerAlgorithm:{type:"string"},SSECustomerKey:{type:"string"},SSECustomerKeyMD5:{type:"string"},SSEKMSKeyId:{type:"string"},ServerSideEncryption:{type:"string"},StorageClass:{type:"string"},Tagging:{type:"string"},UserMetadata:{type:"array",items:{type:"object",properties:{Key:{type:"string"},Value:{type:"string"}}}},WebsiteRedirectLocation:{type:"string"}}},IS_CopyObject={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","CopySource","Key"],properties:{Bucket:{type:"string"},CopySource:{type:"string"},Key:{type:"string"},ACL:{type:"string"},CacheControl:{type:"string"},ContentDisposition:{type:"string"},ContentEncoding:{type:"string"},ContentLanguage:{type:"string"},ContentType:{type:"string"},CopySourceIfMatch:{type:"string"},CopySourceIfModifiedSince:{type:"string",format:"date-time"},CopySourceIfNoneMatch:{type:"string"},CopySourceIfUnmodifiedSince:{type:"string",format:"date-time"},CopySourceSSECustomerAlgorithm:{type:"string"},CopySourceSSECustomerKey:{type:"string"},CopySourceSSECustomerKeyMD5:{type:"string"},Expires:{type:"string",format:"date-time"},GrantFullControl:{type:"string"},GrantRead:{type:"string"},GrantReadACP:{type:"string"},GrantWriteACP:{type:"string"},MetadataDirective:{type:"string"},RequestPayer:{type:"string"},SSECustomerAlgorithm:{type:"string"},SSECustomerKey:{type:"string"},SSECustomerKeyMD5:{type:"string"},SSEKMSKeyId:{type:"string"},ServerSideEncryption:{type:"string"},StorageClass:{type:"string"},Tagging:{type:"string"},TaggingDirective:{type:"string"},UserMetadata:{type:"array",items:{type:"object",properties:{Key:{type:"string"},Value:{type:"string"}}}},WebsiteRedirectLocation:{type:"string"}}},OS_CreateBucket={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{BucketName:{type:"string"},Location:{type:"string"}}},OS_UploadObject={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{ETag:{type:"string"},Expiration:{type:"string"},RequestCharged:{type:"string"},SSECustomerAlgorithm:{type:"string"},SSECustomerKeyMD5:{type:"string"},SSEKMSKeyId:{type:"string"},ServerSideEncryption:{type:"string"},VersionId:{type:"string"}}},OS_CopyObject={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{CopyObjectResult:{type:"object",properties:{ETag:{type:"string"},LastModified:{type:"string"}}},CopySourceVersionId:{type:"string"},Expiration:{type:"string"},RequestCharged:{type:"string"},SSECustomerAlgorithm:{type:"string"},SSECustomerKeyMD5:{type:"string"},SSEKMSKeyId:{type:"string"},ServerSideEncryption:{type:"string"},VersionId:{type:"string"}}},putHandler=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.injector=e,i.http=r,i.value=function(t,e){var r=e.getField("connection").value,n=e.getField("serviceName").value,o=e.getField("putType").value,s=e.getField("inputType").value;switch(t){case"connection":return Observable_1.Observable.create(function(t){var e=[];wi_contrib_1.WiContributionUtils.getConnections(i.http,"AWS").subscribe(function(r){console.log("connection ref response: ",r),r.forEach(function(t){for(var r=0;r<t.settings.length;r++)if("name"===t.settings[r].name){e.push({unique_id:wi_contrib_1.WiContributionUtils.getUniqueId(t),name:t.settings[r].value});break}}),console.log("connection ref is:",e),t.next(e),console.log(r)})});case"serviceName":if(r)return ServiceNameList;break;case"putType":if(r&&"object"===n)return PutTypeList;break;case"inputType":if(r&&"object"===n&&"upload"===o)return Observable_1.Observable.create(function(t){wi_contrib_1.WiContributionUtils.getAppConfig(i.http).subscribe(function(e){e.deployment===wi_contrib_1.APP_DEPLOYMENT.ON_PREMISE?t.next(InputTypeList_FE):t.next(InputTypeList_TCI)},function(e){t.next(InputTypeList_TCI)},function(){return t.complete()})});break;case"input":if(r&&n)return JSON.stringify(i.inputSchemaProvider(n,o,s));break;case"output":if(r&&n)return JSON.stringify(i.outputSchemaProvider(n,o));break;case"error":if(r&&n)return JSON.stringify(ErrorSchema)}},i.validate=function(t,e){if("putType"===t)return"object"===e.getField("serviceName").value?wi_contrib_1.ValidationResult.newValidationResult().setVisible(!0):wi_contrib_1.ValidationResult.newValidationResult().setVisible(!1);if("inputType"===t){var r=e.getField("serviceName"),i=e.getField("putType");return"object"===r.value&&"upload"===i.value?wi_contrib_1.ValidationResult.newValidationResult().setVisible(!0):wi_contrib_1.ValidationResult.newValidationResult().setVisible(!1)}if("preserveACL"===t){r=e.getField("serviceName"),i=e.getField("putType");return"object"===r.value&&"copy"===i.value?wi_contrib_1.ValidationResult.newValidationResult().setVisible(!0):wi_contrib_1.ValidationResult.newValidationResult().setVisible(!1)}return Observable_1.Observable.create(function(t){var e=wi_contrib_1.ValidationResult.newValidationResult();t.next(e)})},i.action=function(t,e){return Observable_1.Observable.create(function(t){var e=wi_contrib_1.ActionResult.newActionResult();t.next(e)})},i}return __extends(e,t),e.prototype.inputSchemaProvider=function(t,e,r){switch(t){case"bucket":return IS_CreateBucket;case"object":switch(e){case"upload":return"file"===r?IS_UploadObject_File:"text"===r?IS_UploadObject_Text:"";case"copy":return IS_CopyObject;default:return""}}},e.prototype.outputSchemaProvider=function(t,e){switch(t){case"bucket":return OS_CreateBucket;case"object":switch(e){case"upload":return OS_UploadObject;case"copy":return OS_CopyObject;default:return""}}},e}(wi_contrib_1.WiServiceHandlerContribution);putHandler=__decorate([wi_contrib_1.WiContrib({}),core_1.Injectable(),__metadata("design:paramtypes",[core_1.Injector,http_1.Http])],putHandler),exports.putHandler=putHandler;
//# sourceMappingURL=putHandler.js.map
