"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),__decorate=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),http_1=require("@angular/http"),Observable_1=require("rxjs/Observable"),wi_contrib_1=require("wi-studio/app/contrib/wi-contrib"),ServiceNameList=[{unique_id:"bucket",name:"Bucket"},{unique_id:"object",name:"Object"}],BucketUpdateTypeList=[{unique_id:"acl",name:"ACL"},{unique_id:"cors",name:"CORS"},{unique_id:"policy",name:"Policy"},{unique_id:"versioning",name:"Versioning"},{unique_id:"website",name:"Website"}],ObjectUpdateTypeList=[{unique_id:"acl",name:"ACL"},{unique_id:"tagging",name:"Tagging"}],ErrorSchema={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{code:{type:"string"},message:{type:"string"},statusCode:{type:"integer"},requestId:{type:"string"}}},IS_Bucket_ACL={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket"],properties:{Bucket:{type:"string"},ACL:{type:"string"},AccessControlPolicy:{type:"object",properties:{Grants:{type:"array",items:{type:"object",properties:{Grantee:{type:"object",properties:{DisplayName:{type:"string"},EmailAddress:{type:"string"},ID:{type:"string"},Type:{type:"string"},URI:{type:"string"}}},Permission:{type:"string"}}}},Owner:{type:"object",properties:{DisplayName:{type:"string"},ID:{type:"string"}}}}},GrantFullControl:{type:"string"},GrantRead:{type:"string"},GrantReadACP:{type:"string"},GrantWrite:{type:"string"},GrantWriteACP:{type:"string"}}},IS_Bucket_CORS={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","CORSConfiguration"],properties:{Bucket:{type:"string"},CORSConfiguration:{type:"object",required:["CORSRules"],properties:{CORSRules:{type:"array",items:{type:"object",required:["AllowedMethods","AllowedOrigins"],properties:{AllowedHeaders:{type:"array",items:{type:"string"}},AllowedMethods:{type:"array",items:{type:"string"}},AllowedOrigins:{type:"array",items:{type:"string"}},ExposeHeaders:{type:"array",items:{type:"string"}},MaxAgeSeconds:{type:"integer"}}}}}}}},IS_Bucket_Policy={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","Policy"],properties:{Bucket:{type:"string"},Policy:{type:"string"},ConfirmRemoveSelfBucketAccess:{type:"boolean"}}},IS_Bucket_Versioning={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","VersioningConfiguration"],properties:{Bucket:{type:"string"},VersioningConfiguration:{type:"object",properties:{MFADelete:{type:"string"},Status:{type:"string"}}},MFA:{type:"string"}}},IS_Bucket_Website={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","WebsiteConfiguration"],properties:{Bucket:{type:"string"},WebsiteConfiguration:{type:"object",properties:{ErrorDocument:{type:"object",required:["Key"],properties:{Key:{type:"string"}}},IndexDocument:{type:"object",required:["Suffix"],properties:{Suffix:{type:"string"}}},RedirectAllRequestsTo:{type:"object",properties:{HostName:{type:"string"},Protocol:{type:"string"}}},RoutingRules:{type:"array",items:{type:"object",properties:{Condition:{type:"object",properties:{HttpErrorCodeReturnedEquals:{type:"string"},KeyPrefixEquals:{type:"string"}}},Redirect:{type:"object",properties:{HostName:{type:"string"},HttpRedirectCode:{type:"string"},Protocol:{type:"string"},ReplaceKeyPrefixWith:{type:"string"},ReplaceKeyWith:{type:"string"}}}}}}}}}},IS_Object_ACL={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","Key"],properties:{Bucket:{type:"string"},Key:{type:"string"},ACL:{type:"string"},AccessControlPolicy:{type:"object",properties:{Grants:{type:"array",items:{type:"object",properties:{Grantee:{type:"object",properties:{DisplayName:{type:"string"},EmailAddress:{type:"string"},ID:{type:"string"},Type:{type:"string"},URI:{type:"string"}}},Permission:{type:"string"}}}},Owner:{type:"object",properties:{DisplayName:{type:"string"},ID:{type:"string"}}}}},GrantFullControl:{type:"string"},GrantRead:{type:"string"},GrantReadACP:{type:"string"},GrantWrite:{type:"string"},GrantWriteACP:{type:"string"},RequestPayer:{type:"string"},VersionId:{type:"string"}}},IS_Object_Tagging={$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["Bucket","Key","Tagging"],properties:{Bucket:{type:"string"},Key:{type:"string"},Tagging:{type:"object",required:["TagSet"],properties:{TagSet:{type:"array",items:{type:"object",required:["Key","Value"],properties:{Key:{type:"string"},Value:{type:"string"}}}}}},VersionId:{type:"string"}}},Empty_Struct={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{}},OS_Object_ACL={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{RequestCharged:{type:"string"}}},OS_Object_Tagging={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{VersionId:{type:"string"}}},updateHandler=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.injector=t,i.http=r,i.value=function(e,t){var r=t.getField("connection").value,n=t.getField("serviceName").value,s=t.getField("updateType").value;switch(e){case"connection":return Observable_1.Observable.create(function(e){var t=[];wi_contrib_1.WiContributionUtils.getConnections(i.http,"AWS").subscribe(function(r){console.log("connection ref response: ",r),r.forEach(function(e){for(var r=0;r<e.settings.length;r++)if("name"===e.settings[r].name){t.push({unique_id:wi_contrib_1.WiContributionUtils.getUniqueId(e),name:e.settings[r].value});break}}),console.log("connection ref is:",t),e.next(t),console.log(r)})});case"serviceName":if(r)return ServiceNameList;break;case"updateType":if(r){if("bucket"===n)return BucketUpdateTypeList;if("object"===n)return ObjectUpdateTypeList}break;case"input":if(r)return JSON.stringify(i.inputSchemaProvider(n,s));break;case"output":if(r)return JSON.stringify(i.outputSchemaProvider(n,s));break;case"error":if(r)return JSON.stringify(ErrorSchema)}},i.validate=function(e,t){return Observable_1.Observable.create(function(e){var t=wi_contrib_1.ValidationResult.newValidationResult();e.next(t)})},i.action=function(e,t){return Observable_1.Observable.create(function(e){var t=wi_contrib_1.ActionResult.newActionResult();e.next(t)})},i}return __extends(t,e),t.prototype.inputSchemaProvider=function(e,t){switch(e){case"object":switch(t){case"acl":return IS_Object_ACL;case"tagging":return IS_Object_Tagging;default:return Empty_Struct}case"bucket":switch(t){case"acl":return IS_Bucket_ACL;case"cors":return IS_Bucket_CORS;case"policy":return IS_Bucket_Policy;case"versioning":return IS_Bucket_Versioning;case"website":return IS_Bucket_Website;default:return Empty_Struct}}},t.prototype.outputSchemaProvider=function(e,t){switch(e){case"object":switch(t){case"acl":return OS_Object_ACL;case"tagging":return OS_Object_Tagging;default:return Empty_Struct}case"bucket":return Empty_Struct}},t}(wi_contrib_1.WiServiceHandlerContribution);updateHandler=__decorate([wi_contrib_1.WiContrib({}),core_1.Injectable(),__metadata("design:paramtypes",[core_1.Injector,http_1.Http])],updateHandler),exports.updateHandler=updateHandler;
//# sourceMappingURL=updateHandler.js.map
