"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),__decorate=this&&this.__decorate||function(e,t,r,a){var n,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(i<3?n(o):i>3?n(t,r,o):n(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),http_1=require("@angular/http"),Observable_1=require("rxjs/Observable"),wi_contrib_1=require("wi-studio/app/contrib/wi-contrib"),lodash=require("lodash"),PutRecordIntoDataStreamInputSchema={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{Data:{type:"any",description:"The data blob to put into the record.",required:"true"},ExplicitHashKey:{type:"string",description:"The hash value used to explicitly determine the shard the data record is assigned to by overriding the partition key hash.",required:"false"},PartitionKey:{type:"string",description:"The name of the data stream.",required:"true",minLength:1,maxLength:256},SequenceNumberForOrdering:{type:"string",required:"false",description:"Guarantees strictly increasing sequence numbers, for puts from the same client and to the same partition key"},StreamName:{type:"string",required:"true",minLength:1,maxLength:128}},required:["Data","StreamName","PartitionKey"]},PutRecordIntoDataStreamOutputSchema={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{EncryptionType:{type:"string"},SequenceNumber:{type:"string"},ShardId:{type:"string"}}},PutRecordsIntoDataStreamInputSchema={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{Records:{type:"array",description:"The data blob to put into the record.",required:"true",items:{type:"object",properties:{Data:{type:"any",required:"true"},ExplicitHashKey:{type:"string",required:"false"},PartitionKey:{type:"string",required:"true"}},required:["Data","PartitionKey"]}},StreamName:{type:"string",required:"true",minLength:1,maxLength:128}},required:["StreamName"]},PutRecordsIntoDataStreamOutputSchema={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{EncryptionType:{type:"string"},FailedRecordCount:{type:"integer"},Records:{type:"object",properties:{ErrorCode:{type:"string",required:"false"},ErrorMessage:{type:"string",required:"false"},SequenceNumber:{type:"string",required:"false"},ShardId:{type:"string",required:"false"}}}}},PutRecordIntoDeliveryStreamInputSchema={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{DeliveryStreamName:{type:"string",required:"true",minLength:1,maxLength:128},Record:{type:"object",description:"The data blob to put into the record.",properties:{Data:{type:"any",required:"true",minLength:0,maxLength:1024e3}},required:["Data"]}},required:["DeliveryStreamName","Data"]},PutRecordIntoDeliveryStreamOutputSchema={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{RecordId:{type:"string"}}},PutRecordsIntoDeliveryStreamInputSchema={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{DeliveryStreamName:{type:"string",required:"true",minLength:1,maxLength:128},Records:{type:"array",description:"The data blob to put into the record.",required:"true",items:{type:"object",properties:{Data:{type:"any",required:"true",minLength:0,maxLength:1024e3}},required:["Data"]}}},required:["DeliveryStreamName","Data"]},PutRecordsIntoDeliveryStreamOutputSchema={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{FailedPutCount:{type:"integer"},RequestResponses:{type:"array",items:{type:"object",properties:{ErrorCode:{type:"string",required:"false"},ErrorMessage:{type:"string",required:"false"},RecordId:{type:"string",required:"false"}}}}}},KinesisErrorConfiguration={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{error_code:{type:"string",required:"false"},error_message:{type:"string",required:"false"},requestId:{type:"string",required:"false"},statusCode:{type:"string",required:"false"}}},putHandler=function(e){function t(t,r){var a=e.call(this,t,r)||this;return a.injector=t,a.http=r,a.value=function(e,t){var r=t.getField("awsConnection").value,n=t.getField("streamType").value,i=t.getField("recordType").value;switch(e){case"awsConnection":return Observable_1.Observable.create(function(e){var t=[];wi_contrib_1.WiContributionUtils.getConnections(a.http,"AWS").subscribe(function(r){r.forEach(function(e){for(var r=0;r<e.settings.length;r++)if("name"===e.settings[r].name){t.push({unique_id:wi_contrib_1.WiContributionUtils.getUniqueId(e),name:e.settings[r].value});break}}),e.next(t)})});case"input":var o;if(n&&r&&i)return Observable_1.Observable.create(function(e){"DataStream"===n?"SingleRecord"===i?o=lodash.cloneDeep(PutRecordIntoDataStreamInputSchema):"MultipleRecords"===i&&(o=lodash.cloneDeep(PutRecordsIntoDataStreamInputSchema)):"Firehose-DeliveryStream"===n&&("SingleRecord"===i?o=lodash.cloneDeep(PutRecordIntoDeliveryStreamInputSchema):"MultipleRecords"===i&&(o=lodash.cloneDeep(PutRecordsIntoDeliveryStreamInputSchema))),null!==o?e.next(JSON.stringify(o)):e.next(o)});case"Message":var s;if(n&&r&&i)return Observable_1.Observable.create(function(e){"DataStream"===n?"SingleRecord"===i?s=lodash.cloneDeep(PutRecordIntoDataStreamOutputSchema):"MultipleRecords"===i&&(s=lodash.cloneDeep(PutRecordsIntoDataStreamOutputSchema)):"Firehose-DeliveryStream"===n&&("SingleRecord"===i?s=lodash.cloneDeep(PutRecordIntoDeliveryStreamOutputSchema):"MultipleRecords"===i&&(s=lodash.cloneDeep(PutRecordsIntoDeliveryStreamOutputSchema))),null!==s?e.next(JSON.stringify(s)):e.next(s)});case"Error":return Observable_1.Observable.create(function(e){var t=lodash.cloneDeep(KinesisErrorConfiguration);null!=t?e.next(JSON.stringify(t)):e.next(t)});default:return null}},a.validate=function(e,t){return Observable_1.Observable.create(function(e){var t=wi_contrib_1.ValidationResult.newValidationResult();e.next(t)})},a.action=function(e,t){return Observable_1.Observable.create(function(e){var t=wi_contrib_1.ActionResult.newActionResult();e.next(t)})},a}return __extends(t,e),t}(wi_contrib_1.WiServiceHandlerContribution);putHandler=__decorate([wi_contrib_1.WiContrib({}),core_1.Injectable(),__metadata("design:paramtypes",[core_1.Injector,http_1.Http])],putHandler),exports.putHandler=putHandler;
//# sourceMappingURL=putHandler.js.map
